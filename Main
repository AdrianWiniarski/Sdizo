#include "stdafx.h"
#include <iostream>
#include <time.h>
#include <conio.h>
#include <string>
#include <fstream>
#include "Tablica.h"
#include "Lista.h"
#include "Kopiec.h"
#include <windows.h>
#include "ConsoleApplication8.h"

using namespace std;

LARGE_INTEGER startTimer()
{
	LARGE_INTEGER start;
	DWORD_PTR oldmask = SetThreadAffinityMask(GetCurrentThread(), 0);
	QueryPerformanceCounter(&start);
	SetThreadAffinityMask(GetCurrentThread(), oldmask);
	return start;
}

LARGE_INTEGER endTimer()
{
	LARGE_INTEGER stop;
	DWORD_PTR oldmask = SetThreadAffinityMask(GetCurrentThread(), 0);
	QueryPerformanceCounter(&stop);
	SetThreadAffinityMask(GetCurrentThread(), oldmask);
	return stop;
}



void displayMenu(string info)
{

	cout << endl;
	cout << info << endl;
	cout << "1.zaladuj Tablice" << endl;
	cout << "2.Usun na poczatku" << endl;
	cout << "3.Usun na koncu" << endl;
	cout << "4.Dodaj na poczatku" << endl;
	cout << "5.Dodaj na koncu" << endl;
	cout << "6.Dodaj losowo" << endl;
	cout << "7.Usun losowo" << endl;
	cout << "8.Wyswietl" << endl;
	cout << "9.Test (pomiary)" << endl;
	cout << "0.Powrot do menu" << endl;
	cout << "Podaj opcje:";
}

void displayMenu1(string info)
{

	cout << endl;
	cout << info << endl;
	cout << "1.zaladuj z pliku" << endl;
	cout << "2.Usun z listy" << endl;;
	cout << "3.Dodaj do listy" << endl;
	cout << "4.znajdz" << endl;
	cout << "5.Wyswietl" << endl;
	cout << "6.Test (pomiary)" << endl;
	cout << "0.Powrot do menu" << endl;
	cout << "Podaj opcje:";
}

//Table myTab; //myTab może być dynamiczna, może byc zadeklarowana w manu_table 
void displayMenu2(string info)
{

	cout << endl;
	cout << info << endl;
	cout << "1.Dodaj do kopca" << endl;
	cout << "2.Usun z kopca" << endl;;
	cout << "3.znajdz" << endl;
	cout << "4.wyswiatl" << endl;
	cout << "5.zaladuj" << endl;
	cout << "6.Test (pomiary)" << endl;
	cout << "0.Powrot do menu" << endl;
	cout << "Podaj opcje:";
}

void menu_tablicy()
{
	char opt1, opt2;
	int index, value;
	Tablica myTab;

	do {
		displayMenu("--- TABLICA ---");
		opt1 = getch();
		cout << endl;
		switch (opt1) {
		case '1': //Tworzenie tablicy
			myTab.zaladujzpliku();
			myTab.wypisztablice();
			break;

		case '2': //Usuwanie elementu z tablicy na poczatku
			myTab.usunliczbenap();
			myTab.wypisztablice();
			break;

		case '3': //usuwanie elemetu do tablicy na koncu
			myTab.usunliczbenak();
			myTab.wypisztablice();
			break;

		case '4': //dodawanie liczby na poczatku
			myTab.dodajliczbenap();
			myTab.wypisztablice();
			break;
		case '5':  //dodaj liczbe na koncu
			myTab.dodajliczbenak();
			myTab.wypisztablice();
			break;

		case '6': //tutaj nasza funkcja do eksperymentów (pomiary czasów i generowanie daneych) - nie będzie testowana przez prowadzącego 
			myTab.dodajliczbelos();
			myTab.wypisztablice();
			break;
		case '7':
			myTab.usunliczbelos();
			myTab.wypisztablice();
			break;
		case '8': //wyswietla tablice
			myTab.wypisztablice();
			break;
		case '9':

			do {

				displayMenu("--- POMIAR CZASU ---");
				opt2 = getch();
				cout << endl;
				LARGE_INTEGER performanceCountStart, performanceCountEnd;
				performanceCountStart = startTimer(); //zapamiętujemy czas początkowy
				switch (opt2) {

				case '1': // Wczytywanie tablicy z pliku
				{
					myTab.zaladujzpliku(); //tutaj funkcje, których mierzymy wydajność
					break;
				}
				case '2': //Usuwanie elementu z tablicy na poczatku
					myTab.usunliczbenap();
					myTab.wypisztablice();
					break;

				case '3': //usuwanie elemetu do tablicy na koncu
					myTab.usunliczbenak();
					myTab.wypisztablice();
					break;

				case '4': //dodawanie liczby na poczatku
					myTab.dodajliczbenap();
					myTab.wypisztablice();
					break;
				case '5':  //dodaj liczbe na koncu
					myTab.dodajliczbenak();
					myTab.wypisztablice();
					break;

				case '6': //tutaj nasza funkcja do eksperymentów (pomiary czasów i generowanie daneych) - nie będzie testowana przez prowadzącego 
					myTab.dodajliczbelos();
					myTab.wypisztablice();
					break;
				case '7':
					myTab.usunliczbelos();
					myTab.wypisztablice();
					break;
				case '8': //wyswietla tablice
					myTab.wypisztablice();
					break;



				}
				performanceCountEnd = endTimer(); //zapamiętujemy koniec czasu
				double tm = performanceCountEnd.QuadPart - performanceCountStart.QuadPart;
				cout << endl << "Time:" << tm << endl;

			} while (opt2 != '0');
		}

	} while (opt1 != '0');

}

void menu_listy()
{
	char opt1, opt2;
	int index, value;
	Lista myList;


	do {
		displayMenu1("--- LISTA ---");
		opt1 = getch();
		cout << endl;
		switch (opt1) {
		case '1': // Wczytywanie listy z pliku
			myList.zaladujzplikulista();
			myList.wyswietl();
			break;

		case '2': //Usuwanie elementu z listy
			cout << " Podaj index:";
			cin >> index;
			myList.usunzlisty(index);
			myList.wyswietl();
			break;

		case '3': //Dodawanie elementu do listy
			cout << "Podaj indeks: ";
			cin >> index;
			cout << " Podaj wartosc:";
			cin >> value;
			myList.dodajdolisty(index, value);
			myList.wyswietl();
			break;

		case '4': //Znajdowanie elementu w liscie
			cout << " Podaj wartosc:";
			cin >> value;
			if (myList.czyjestwsrod(value))
				cout << "Podana wartosc jest w tablicy";
			else
				cout << "Podanej wartosci nie ma w tablicy";
			break;

		case '5':  //Wyswietlanie listy
			myList.wyswietl();
			break;
		case'6':
			do {

				displayMenu1("--- POMIAR CZASU ---");
				opt2 = getch();
				cout << endl;
				LARGE_INTEGER performanceCountStart, performanceCountEnd;
				performanceCountStart = startTimer(); //zapamiętujemy czas początkowy
				switch (opt2) {

				case '1': // Wczytywanie listy z pliku
					myList.zaladujzplikulista();
					myList.wyswietl();
					break;

				case '2': //Usuwanie elementu z listy
					cout << " Podaj index:";
					cin >> index;
					myList.usunzlisty(index);
					myList.wyswietl();
					break;

				case '3': //Dodawanie elementu do listy
					cout << "Podaj indeks: ";
					cin >> index;
					cout << " Podaj wartosc:";
					cin >> value;
					myList.dodajdolisty(index, value);
					myList.wyswietl();
					break;

				case '4': //Znajdowanie elementu w liscie
					cout << " Podaj wartosc:";
					cin >> value;
					if (myList.czyjestwsrod(value))
						cout << "Podana wartosc jest w tablicy";
					else
						cout << "Podanej wartosci nie ma w tablicy";
					break;

				case '5':  //Wyswietlanie listy
					myList.wyswietl();
					break;



				}
				performanceCountEnd = endTimer(); //zapamiętujemy koniec czasu
				double tm = performanceCountEnd.QuadPart - performanceCountStart.QuadPart;
				cout << endl << "Time:" << tm << endl;

			} while (opt2 != '0');




		}

	} while (opt1 != '0');
}

void menu_kopca()
{
	int index, liczba;
	char opt1,opt2;
	Kopiec myHeap;

	do {
		displayMenu2("--- KOPIEC ---");
		opt1 = getch();
		cout << endl;
		switch (opt1) {
		case '1': //dodaj kpiec
			cout << " Podaj wartosc:";
			cin >> index;
			myHeap.dodajdokopca(index);
			myHeap.wyswietlkopiec();
			break;

		case '2': //Usuwanie elementu z kopca
			cout << " Podaj wartosc:";
			cin >> liczba;
			myHeap.usunzkopca(liczba);
			myHeap.wyswietlkopiec();
			break;
		case'3'://znajdowanie elem w kopcu
			cout << "Podaj wartosc:";
			cin >> liczba;
			if (myHeap.czyjestwsrod(liczba))
				cout << "Podana wartosc jest na liscie";
			else
				cout << "Podanej wartosci NIE ma na liscie";
			break;

		case '4': //wyswietl kopiec
			myHeap.wyswietlkopiec();
			break;

		case '5': //zaladuj
			myHeap.zaladujzpliku();
			myHeap.wyswietlkopiec();
			break;
		case '6':  //TEST
			do {

				displayMenu2("--- POMIAR CZASU ---");
				opt2 = getch();
				cout << endl;
				LARGE_INTEGER performanceCountStart, performanceCountEnd;
				performanceCountStart = startTimer(); //zapamiętujemy czas początkowy
				switch (opt2) {

				case '1': //dodaj kpiec
					cout << " Podaj wartosc:";
					cin >> index;
					myHeap.dodajdokopca(index);
					myHeap.wyswietlkopiec();
					break;

				case '2': //Usuwanie elementu z kopca
					cout << " Podaj wartosc:";
					cin >> liczba;
					myHeap.usunzkopca(liczba);
					myHeap.wyswietlkopiec();
					break;
				case'3'://znajdowanie elem w kopcu
					cout << "Podaj wartosc:";
					cin >> liczba;
					if (myHeap.czyjestwsrod(liczba))
						cout << "Podana wartosc jest na liscie";
					else
						cout << "Podanej wartosci NIE ma na liscie";
					break;

				case '4': //wyswietl kopiec
					myHeap.wyswietlkopiec();
					break;

				case '5': //zaladuj
					myHeap.zaladujzpliku();
					break;

				}
				performanceCountEnd = endTimer(); //zapamiętujemy koniec czasu
				double tm = performanceCountEnd.QuadPart - performanceCountStart.QuadPart;
				cout << endl << "Time:" << tm << endl;

			} while (opt2 != '0');
			break;

		}

	} while (opt1 != '0');
}

int main(int argc, char* argv[])
{
	srand(time(NULL));

	char option;
	do {
		cout << endl;
		cout << "==== MENU GLOWNE ===" << endl;
		cout << "1.Tablica" << endl;
		cout << "2.Lista" << endl;
		cout << "3.Kopiec" << endl;
		cout << "0.Wyjscie" << endl;
		cout << "Podaj opcje:";
		option = getch();
		cout << endl;

		switch (option) {
		case '1':
			menu_tablicy();
			break;

		case '2':
			menu_listy();
			break;

		case '3':
			menu_kopca();
			break;
		}

	} while (option != '0');


	return 0;
}

